<p>Server Side</p>
<pre><code class="javascript" data-trim contenteditable style="font-size: 18px; max-height: 500px;">
io.sockets.on('connection', function (socket) {

    // Set the nickname property for a given client
    socket.on('nick', function(nick) {
        socket.set('nickname', nick);
    });

    // Relay chat data to all clients
    socket.on('chat', function(data) {
        socket.get('nickname', function(err, nick) {
            var nickname = err ? 'Anonymous' : nick;

            var payload = {
                message: data.message,
                nick: nickname
            };

            io.sockets.emit('chat', payload)
        });
    });
});
</code></pre>
